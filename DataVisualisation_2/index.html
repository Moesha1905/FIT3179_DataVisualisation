<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">

  <!-- Vega Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- Google font (title)-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Charm:wght@400;700&family=Fondamento:ital@0;1&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

</head>

<body>
  <div class="dashboard">
    <header>
      <h1>Tourism Pulse of Malaysia</h1>
      <!-- <span class="subtext">
        Major focus on 2016 - 2019
      </span> -->
    </header>

    <!-- === NUMBER CARDS SECTION === -->
    <section class="number-cards">
      <div class="number-card">
        <div class="region-name">Total Arrivals</div>
        <div id="arrivalsValue" class="number-value"></div>
      </div>

      <div class="number-card">
        <div class="region-name">Total Spendings</div>
        <div id="receiptsValue" class="number-value"></div>
      </div>

      <div class="number-card">
        <div class="yearselector">
          <select id="yearSelect" class="year-dropdown"></select>
          <div class="info-icon">
            <img src="info_image.png" alt="Info" class="info-icon-img"/>
          </div>
        </div>
      </div>
    </section>

    <!-- === FIRST ROW (ONE VISUALIZATION) === -->
    <section class="viz-row full-width">
      <div class="viz1">
        <h3>Across The World</h3>
        <p>Over the years, <span class="highlight">Malaysia</span> has welcomed travelers from every continent. This international diversity showcases Malaysia's position as one of Southeast Asia's most accessible and attractive destinations!
           <span class="column-break"> Understanding where visitors come from provides valuable insights into global travel trends and <span class="highlight">Malaysia's</span> international appeal. These patterns reveal the countries that form <span class="highlight">Malaysia's</span> strongest tourism partnerships.</p></span> 
        <div id="viz1" class="placeholder"></div>
      </div>
    </section>

    <!-- === SECOND ROW (ONE VISUALIZATION) === -->
    <section class="viz-row full-width">
      <div class="viz2">
        <h3>Across the Nation</h3>
        <p> <span class="highlight">Malaysia's tourism</span> landscape is shaped by its cultural diversity, natural beauty, and vibrant cities. Visitors are drawn to different states for distinct experiences - from island escapes to urban adventures - making regional trends in tourist arrivals especially revealing. <span class="column-break">Each state contributes uniquely to <span class="highlight">Malaysia's</span> growing appeal as a global travel hub - whether through cultural festivals, eco-tourism adventures, culinary diversity, or urban innovation.</p>
        <div id="viz2" class="placeholder"></div>
        <p>
          <span class="note">Note: This visualisation focuses on the latest available year of data (2019).</span>
        </p>
      </div>
    </section>

    <!-- === THIRD ROW (TWO VISUALIZATIONS) === -->
    <section class="viz-row two-col">
      <div class="viz3">
        <h3>Achieving Satisfaction</h3>
        <p><span class="highlight">Malaysia's</span> rich blend of cultures, cuisines, and natural attractions creates a memorable experience for travelers from around the world. Visitors often find delight in the nation's flavorful food, vibrant cultural heritage, and the warmth of its people - elements that define <span class="highlight">Malaysia's</span> charm and contribute to its reputation as a welcoming and unforgettable destination.</p>
        <div id="viz3" class="placeholder"></div>
        <p>
          <span class="note">Note: This visualisation focuses on the latest available year of data (2019).</span>
        </p>
      </div>

      <div class="viz4">
        <h3>Returning for Magic</h3>
        <p><span class="highlight">Malaysia's</span> charm goes beyond a single visit. Many travellers find themselves returning to explore more of its captivating blend of culture, flavour, and warmth. </p>
        <div id="viz4" class="placeholder"></div>
      </div>
    </section>

    <!-- === FOURTH ROW (TWO VISUALIZATIONS) === -->
    <section class="viz-row two-col">
      <div class="viz5">
        <h3>Captivating Interest</h3>
        <p>From bustling street markets to breathtaking island views, <span class="highlight">Malaysia</span> offers experiences that appeal to every kind of traveller. Many visitors are especially inspired by the opportunity to explore its iconic landmarks and indulge in its lively shopping scenes - main charm of the nation!</p>
        <div id="viz5" class="placeholder"></div>
        <p>
          <span class="note">Note: This visualisation focuses on the latest available year of data (2019).</span>
        </p>
      </div>

      <div class="viz6">
        <h3>Journey to Paradise</h3>
        <p><span class="highlight">Malaysia's</span> well-connected transport network enables millions of visitors to enter the country each year. Land routes that link neighboring nations, continue to lead in tourist arrivals, while growing air travel signals an increasing appeal among international travelers</p>
        <div id="viz6" class="placeholder"></div>
      </div>
    </section>
  </div>

  <footer>
    A visualisation by <strong>Moesha Novyna</strong> <br>
    Last Updated on <strong>21/10/2025</strong> <br>
    Data Sources: 
    <strong>
      <a href="https://archive.data.gov.my/data/organization/lembaga-penggalakkan-pelancongan-malaysia?q=&sort=title_string+asc" target="_blank" rel="noopener noreferrer">Ministry of Tourism (Malaysia)</a>, 
      <a href="https://www.kaggle.com/code/yyxian/malaysia-foreign-arrivals" target="_blank" rel="noopener noreferrer">Kaggle</a>, 
      <a href="https://www.researchgate.net/publication/314440159_Tourist_Satisfaction_in_Malaysia" target="_blank" rel="noopener noreferrer">Tourism Research Paper</a>,
      <a href="https://data.worldbank.org/indicator/ST.INT.ARVL?end=2019&locations=MY&start=2016&view=charta" target="_blank" rel="noopener noreferrer">World Data Bank</a>
    </strong>
  </footer>

  <!-- === TOURISM DATA SCRIPT (Number Cards) === -->
  <script>
    async function loadTourismData() {
      let data = [
        { Year: "2016", TotalReceipts: 19682000000, TotalArrivals: 26757000 },
        { Year: "2017", TotalReceipts: 20311000000, TotalArrivals: 25948000 },
        { Year: "2018", TotalReceipts: 21775000000, TotalArrivals: 25832000 },
        { Year: "2019", TotalReceipts: 22200000000, TotalArrivals: 26101000 }
      ];

      try {
        const response = await fetch("./tourism_data.csv");
        if (response.ok) {
          const csvText = await response.text();
          const rows = csvText.trim().split("\n").map(r => r.split(","));
          rows.shift();
          data = rows.map(r => ({
            Year: r[0],
            TotalReceipts: Number(r[1]),
            TotalArrivals: Number(r[2])
          }));
        } else {
          console.warn("CSV not found, using fallback data.");
        }
      } catch (err) {
        console.warn("Error loading CSV, using fallback data:", err);
      }

      const yearSelect = document.getElementById("yearSelect");
      const arrivalsValue = document.getElementById("arrivalsValue");
      const receiptsValue = document.getElementById("receiptsValue");

      data.forEach(d => {
        const opt = document.createElement("option");
        opt.value = d.Year;
        opt.textContent = d.Year;
        yearSelect.appendChild(opt);
      });

      function formatNumber(num) {
        return num.toLocaleString("en-US");
      }

      function updateValues(year) {
        const selected = data.find(d => d.Year === year);
        if (selected) {
          arrivalsValue.textContent = formatNumber(selected.TotalArrivals);
          receiptsValue.textContent = "$ " + (selected.TotalReceipts / 1e9).toFixed(2) + " B";
        }
      }

      const latest = data[data.length - 1].Year;
      yearSelect.value = latest;
      updateValues(latest);

      // Event listener stays here - map update added later
      yearSelect.addEventListener("change", e => {
        const year = e.target.value;
        updateValues(year);
        // If proportional map view exists, update it
        if (window.vegaViews && window.vegaViews["viz1"]) {
          window.vegaViews["viz1"].signal("year_select", +year).runAsync();
        }
      });
    }

    loadTourismData();
  </script>

  <!-- === VEGA EMBEDDING SCRIPT === -->
  <script>
    const embedOptions = { actions: true };
    const visPaths = {
      viz1: "https://raw.githubusercontent.com/Moesha1905/FIT3179_DataVisualisation/refs/heads/main/DataVisualisation_2/proportional_map.json",
      viz2: "https://raw.githubusercontent.com/Moesha1905/FIT3179_DataVisualisation/refs/heads/main/DataVisualisation_2/choropleth_map.json",
      viz3: "https://raw.githubusercontent.com/Moesha1905/FIT3179_DataVisualisation/refs/heads/main/DataVisualisation_2/radar_chart.json",
      viz4: "https://raw.githubusercontent.com/Moesha1905/FIT3179_DataVisualisation/refs/heads/main/DataVisualisation_2/grouped_barchart.json",
      viz5: "https://raw.githubusercontent.com/Moesha1905/FIT3179_DataVisualisation/refs/heads/main/DataVisualisation_2/word_cloud.json",
      viz6: "https://raw.githubusercontent.com/Moesha1905/FIT3179_DataVisualisation/refs/heads/main/DataVisualisation_2/slope_chart.json"
    };

    // Store Vega views for later updates
    window.vegaViews = {};

    async function embedVis(id, url) {
      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error(`Failed to fetch ${url}`);
        const spec = await response.json();

        const result = await vegaEmbed(id, spec, embedOptions);
        window.vegaViews[id.replace("#", "")] = result.view;
      } catch (error) {
        console.error(`Error embedding ${url}:`, error);
      }
    }

    Object.entries(visPaths).forEach(([id, path]) => embedVis(`#${id}`, path));
  </script>
</body>
</html>
